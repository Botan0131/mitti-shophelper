<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- PWA manifest -->
  <link rel="manifest" href="./manifest.json">
  <!-- Favicon for browsers (SVG neon icon) -->
  <link rel="icon" type="image/svg+xml" href="icons/icon-192.svg">
  <title>MITTI‑Helper</title>
  <!-- Main stylesheet -->
  <link rel="stylesheet" href="style.css">
  <!-- Import fonts (Google Fonts for neon style) -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Offline status indicator -->
  <div id="offline-indicator" class="hidden">オフライン</div>

  <!-- Start screen with neon animation -->
  <div id="start-screen" class="screen">
    <div class="logo-container">
      <h1 class="logo-main">MITTI</h1>
      <h2 class="logo-sub">helper</h2>
    </div>
    <button id="start-button" class="primary-button">スタート</button>
  </div>

  <!-- Main application container (hidden until start) -->
  <div id="app" class="hidden">
    <!-- Navigation tabs -->
    <nav class="tabs">
      <button data-tab="calc-tab" class="tab-button active">計算</button>
      <button data-tab="store-tab" class="tab-button">店</button>
      <button data-tab="history-tab" class="tab-button">履歴</button>
      <button data-tab="template-tab" class="tab-button">テンプレ</button>
      <button data-tab="help-tab" class="tab-button">使い方</button>
      <button data-tab="settings-tab" class="tab-button">設定</button>
    </nav>

    <!-- Tab content areas -->
    <section id="calc-tab" class="tab-content">
      <!-- Calculation page -->
      <h2>計算</h2>
      <!-- Store selection -->
      <div class="form-group">
        <label for="store-select">店を選択:</label>
        <select id="store-select"></select>
      </div>
      <!-- Target amount for voucher suggestion -->
      <div class="form-group">
        <label for="target-amount">目標金額 (商品券):</label>
        <input id="target-amount" type="text" readonly data-num="target" value="1000">
      </div>
      <!-- Product table -->
      <table id="product-table">
        <thead>
          <tr>
            <th>名前</th>
            <th>価格 (税抜)</th>
            <th>個数</th>
            <th>税率</th>
            <th>割引 (%)</th>
            <th>削除</th>
          </tr>
        </thead>
        <tbody id="product-body">
        </tbody>
      </table>
      <button id="add-product" class="secondary-button">商品追加</button>
      <!-- Calculation results -->
      <div id="calc-results" class="results"></div>
      <!-- Save to history button -->
      <button id="save-history" class="primary-button">結果を保存</button>
      <!-- Voucher suggestion area -->
      <div id="voucher-suggestion" class="voucher"></div>
    </section>

    <section id="store-tab" class="tab-content hidden">
      <!-- Store management -->
      <h2>店プロフィール</h2>
      <ul id="store-list" class="list"></ul>
      <button id="add-store" class="secondary-button">店追加</button>
      <!-- Store editor modal -->
      <div id="store-editor" class="modal hidden">
        <div class="modal-content">
          <h3 id="store-editor-title">店を編集</h3>
          <label>店名:<input type="text" id="store-name"></label>
          <label>メモ:<input type="text" id="store-memo"></label>
          <label>計算方式:<select id="store-method"><option value="1">個別課税方式</option><option value="2">税率別合算方式</option></select></label>
          <div class="modal-actions">
            <button id="store-save" class="primary-button">保存</button>
            <button id="store-cancel" class="secondary-button">キャンセル</button>
          </div>
        </div>
      </div>
    </section>

    <section id="history-tab" class="tab-content hidden">
      <h2>履歴</h2>
      <div id="history-list" class="list"></div>
      <button id="delete-all-history" class="danger-button">全削除</button>
    </section>

    <section id="template-tab" class="tab-content hidden">
      <h2>テンプレ</h2>
      <div id="template-list" class="list" draggable="true"></div>
      <button id="import-from-history" class="secondary-button">履歴からテンプレ化</button>
    </section>

    <section id="help-tab" class="tab-content hidden">
      <h2>使い方</h2>
      <div class="help-content">
        <!-- Content filled by JS to keep markup concise -->
      </div>
    </section>

    <section id="settings-tab" class="tab-content hidden">
      <h2>設定</h2>
      <div class="form-group">
        <label>ライト/ダークモード:</label>
        <button id="theme-toggle" class="secondary-button">モード切替</button>
      </div>
      <div class="form-group">
        <label>BGM:</label>
        <input type="checkbox" id="bgm-toggle" checked>ON/OFF
        <input type="range" id="bgm-volume" min="0" max="1" step="0.01" value="0.5">
      </div>
      <div class="form-group">
        <label>効果音:</label>
        <input type="checkbox" id="sfx-toggle" checked>ON/OFF
        <input type="range" id="sfx-volume" min="0" max="1" step="0.01" value="0.5">
      </div>
      <div class="form-group">
        <button id="clear-data" class="danger-button">全データ初期化</button>
      </div>
      <p id="audio-note">音を鳴らすには、一度画面をタップしてください。</p>
    </section>
  </div>

  <!-- Numeric keypad overlay for numeric inputs -->
  <div id="num-keypad" class="modal hidden">
    <div class="num-keypad-content">
      <input id="num-display" type="text" readonly>
      <div class="num-buttons">
        <!-- Buttons generated by JS -->
      </div>
      <div class="num-actions">
        <button id="num-ok" class="primary-button">OK</button>
        <button id="num-cancel" class="secondary-button">キャンセル</button>
      </div>
    </div>
  </div>

  <!-- Mini calculator panel -->
  <div id="calculator-panel" class="calc-panel hidden">
    <div class="calc-display">
      <input id="calc-display" type="text" readonly>
    </div>
    <div class="calc-buttons">
      <!-- Buttons created dynamically in JS -->
    </div>
    <div class="calc-actions">
      <button id="calc-copy" class="secondary-button">コピー</button>
      <button id="calc-close" class="secondary-button">閉じる</button>
    </div>
  </div>
  <button id="calc-toggle" class="calc-toggle-button">電卓</button>

  <!-- Tutorial overlay (hidden by default) -->
  <div id="tutorial" class="modal hidden">
    <div class="tutorial-content">
      <div id="tutorial-slide"></div>
      <div class="tutorial-actions">
        <button id="tutorial-next" class="primary-button">次へ</button>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script src="app.js"></script>
</body>
</html>